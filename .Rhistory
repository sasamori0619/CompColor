annotation_df <- left_join(annotation_df, y_max_df, by = "GC_bin") %>%
mutate(y_pos = y_max * 1.05)
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
geom_point(size=0.2,show.legend="none") +
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggsave(paste0(prefix, "_gc_v_div_box.png"),  width=12, height=8, dpi=300)
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
#geom_point(size=0.2,show.legend="none") +
geom_boxplot()+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
#geom_point(size=0.2,show.legend="none") +
geom_boxplot(color="white")+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
#geom_point(size=0.2,show.legend="none") +
geom_boxplot(color="None"+
)
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
#geom_point(size=0.2,show.legend="none") +
geom_boxplot(color="None")+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
#geom_point(size=0.2,show.legend="none") +
geom_boxplot(color="gray")+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
#geom_point(size=0.2,show.legend="none") +
geom_boxplot(color="black")+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
geom_point(size=0.2,show.legend="none") +
geom_boxplot(color="black")+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
geom_boxplot(color="black")+
geom_point(size=0.2,show.legend="none") +
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg, color=Chromosome)) +
geom_boxplot(color="black")+
geom_jitter(size=0.2,show.legend="none") +
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg)) +
geom_boxplot()
ggplot(with_gc, aes(x = GC_bin, y =DivAvg)) +
geom_boxplot()+
#geom_jitter(size=0.2,show.legend="none") +
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
y_max_df <- with_gc %>%
group_by(GC_bin) %>%
summarise(y_max = max(CDS_occupancy, na.rm = TRUE), .groups = "drop")
annotation_df <- left_join(annotation_df, y_max_df, by = "GC_bin") %>%
mutate(y_pos = y_max * 1.05)
y_max_df <- with_gc %>%
group_by(GC_bin) %>%
summarise(y_max = max(CDS_occupancy, na.rm = TRUE), .groups = "drop")
annotation_df <- left_join(annotation_df, y_max_df, by = "GC_bin") %>%
mutate(y_pos = y_max * 1.05)
y_max_df <- with_gc %>%
group_by(GC_bin) %>%
summarise(y_max = max(DivAvg, na.rm = TRUE), .groups = "drop")
y_max_df <- with_gc %>%
group_by(GC_bin) %>%
summarise(y_max = max(DivAvg, na.rm = TRUE), .groups = "drop")
annotation_df <- left_join(annotation_df, y_max_df, by = "GC_bin") %>%
mutate(y_pos = y_max * 1.05)
y_max_df <- with_gc %>%
group_by(GC_bin) %>%
summarise(y_max = max(DivAvg, na.rm = TRUE), .groups = "drop")
annotation_df <- left_join(annotation_df, y_max_df, by = "GC_bin") %>%
mutate(y_pos = y_max * 1.05)
library(multcomp)
library(multcompView)
# aovモデルをfit
anova_model <- aov(DivAvg ~ GC_bin, data = with_gc)
# 多重比較（Tukey）
tukey_result <- glht(anova_model, linfct = mcp(GC_bin = "Tukey"))
# 有意水準をアルファベットで
letters_result <- cld(tukey_result)
# 結果データフレームを抽出
annotation_df <- data.frame(
GC_bin = names(letters_result$mcletters$Letters),
Letters = letters_result$mcletters$Letters
)
count_df <- with_gc %>%
group_by(GC_bin) %>%
summarise(n = n(), .groups = "drop")
annotation_df <- left_join(annotation_df, count_df, by = "GC_bin")
annotation_df <- annotation_df %>%
mutate(label = paste0(Letters, "\n(n=", n, ")"))
y_max_df <- with_gc %>%
group_by(GC_bin) %>%
summarise(y_max = max(DivAvg, na.rm = TRUE), .groups = "drop")
annotation_df <- left_join(annotation_df, y_max_df, by = "GC_bin") %>%
mutate(y_pos = y_max * 1.05)
ggplot(with_gc, aes(x = GC_bin, y =DivAvg)) +
geom_boxplot()+
#geom_jitter(size=0.2,show.legend="none") +
scale_color_jco()+
#scale_fill_lancet()+
geom_text(data = annotation_df,
aes(x = GC_bin, y = y_pos, label = label),
inherit.aes = FALSE,
vjust = 0, size = 3.5) +
ylab("Divergence rate (%)")+
coord_cartesian(ylim=c(0,25))+
#facet_grid(Chromosome~.) +
#facet_grid(.~Chromosome) +
theme_bw()
ggsave(paste0(prefix, "_gc_v_div_boxa.png"),  width=12, height=8, dpi=300)
ggsave(paste0(prefix, "_gc_v_div_box.png"),  width=12, height=8, dpi=300)
library(ggplot2)
library(colorspace)
# 任意の数の補色ペアを交互に返す関数
generate_complementary_palette <- function(n) {
hues <- seq(15, 375, length.out = ceiling(n / 2) + 1)[-1]
colors <- hcl(h = hues, c = 100, l = 65)
complementary <- hcl(h = (hues + 180) %% 360, c = 100, l = 65)
# 交互に配置
as.vector(rbind(colors, complementary))[1:n]
}
library(dplyr)
library(ggplot2)
library(ggrepel)
library(readxl)
library(tidyverse)
library(ggbeeswarm)
library(patchwork)
library(multcomp)
#library(RColorBrewer)
library(ggsci)
# assmbly: Pkra_v2
prefix <- "250701_distr_rep_chr_bin100k"
choice=c("DNA", "LINE", "LTR", "Other", "Unknown", "rRNA", "Satellite", "Simple_repeat", "Low_complexity")
rep <- data.frame(read.table("Pkra_v2_rep.All_occupancy.tsv", header = TRUE)) %>%
#dplyr::filter(Category %in% choice) |>
mutate(Coverage=Coverage/100000)
#dplyr::filter(Category=="LINE_R1")
summary(df)
cds <- read.table("C:/Users/pitto/OneDrive - 国立大学法人東海国立大学機構/Pkra_v2/Pkra_v2_exon_occupancy_bin100k.bedgraph") |>
mutate(Category="CDS")
colnames(cds)<-c("Chromosome", "Start", "End", "Coverage", "Category")
gc <- read.table("C:/Users/pitto/OneDrive - 国立大学法人東海国立大学機構/Pkra_v2/gc_content_bin100k.txt")[,c(1,2,3,5)] |>
mutate(Category="CG_contents")
colnames(gc)<-c("Chromosome", "Start", "End", "Coverage", "Category")
df<-rbind(rep[,1:5], cds, gc)
div<-rep[,c(1:4,7)] |>
#dplyr::filter(Category %in% c("DNA", "LINE", "LTR", "Other", "Unknown")) |>
mutate(tag=paste0(Category, "_", Chromosome))
with_gc <- cbind(gc,cds,dplyr::filter(rep, Category=="transposon"))[,c(1,2,3,4,9,15,17)]
colnames(with_gc)<-c("Chromosome", "Start", "End", "GC_contents", "CDS_occupancy", "RepOccupancy", "DivAvg")
with_gc <- with_gc |>
mutate(GC_bin = cut(GC_contents,
breaks = seq(0, 1, by = 0.01),
include.lowest = TRUE,
right = FALSE,
dig.lab = 3))
ggplot(rep, aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
scale_color_jco()+
scale_fill_lancet()+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
#ggsave(paste0(prefix, "_Div_v_occup_all.png"),  width=12, height=8, dpi=300)
ggplot(rep, aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
generate_complementary_palette(39)+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep, aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
generate_complementary_palette(39)+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep, aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_fill_manual(values = generate_complementary_palette(39))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
#ggsave(paste0(prefix, "_Div_v_occup_all.png"),  width=12, height=8, dpi=300)
ggplot(rep, aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(39))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep, aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(39))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep, aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(10))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
View(rep)
ggplot(rep%>%dplyr::filter(Category %in% "LTR"), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(10))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep%>%dplyr::filter(Category %in% "^LTR*"), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(10))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep%>%dplyr::filter(Category %in% "^LTR"), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(10))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep%>%dplyr::filter(Category %in% ^LTR), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
#scale_color_manual(values = generate_complementary_palette(10))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep%>%dplyr::filter(grepl("LTR", Category)), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
#scale_color_manual(values = generate_complementary_palette(10))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep%>%dplyr::filter(grepl("LTR", Category)), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(5))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep%>%dplyr::filter(grepl("LTR", Category)), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
#scale_color_manual(values = generate_complementary_palette(5))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
ggplot(rep%>%dplyr::filter(grepl("LTR", Category)), aes(x = DivAvg, y =Coverage*100+10^-10, color=Category, fill=Category)) +
geom_point(size=1,show.legend="none") +
#geom_area(alpha=0.3)+
#geom_smooth(aes(), method="loess") +
#geom_bar(stat="identity")+
#scale_color_jco()+
#scale_fill_lancet()+
scale_color_manual(values = generate_complementary_palette(5))+
#scale_y_log10()+
ylab("Occupancy (%)")+
#coord_cartesian(ylim=c(32.5,37.5))+
#coord_cartesian(ylim=c(10^-3,10^2))+
#facet_grid(Chromosome~.) +
facet_wrap(.~Category) +
theme_bw()
library(devtools)
install.packages("devtools")
```{r}
install.packages(c("usethis", "devtools", "roxygen2"))
install.packages(c("usethis", "devtools", "roxygen2"))
usethis::create_package("compcolor")
devtools::document()
library(devtools)
devtools::document()
setwd("C:/Users/pitto/OneDrive - 国立大学法人東海国立大学機構/240917_OmniC_Shigenobu/Repeat/compcolor")
devtools::document()
